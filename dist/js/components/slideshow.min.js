/*!
 *  CliqueUI - v1.0.4 - 2015-10-14
 *  http://ui.cliquestudios.com
 *  Copyright (c) 2015 Clique Studios;
 */

!function(a){var b;window.Clique&&(b=a(Clique)),"function"==typeof define&&define.amd&&define("clique-slideshow",["clique"],function(){return b||a(Clique)})}(function(a){"use strict";var b,c=0;a.component("slideshow",{defaults:{animation:"fade",duration:500,height:"auto",start:0,autoplay:!1,autoplayInterval:7e3,videoautoplay:!0,videomute:!0,kenburns:!1,slices:15,pauseOnHover:!0},current:!1,interval:null,hovering:!1,boot:function(){a.ready(function(b){a.$("[data-slideshow]",b).each(function(){var b=a.$(this);if(!b.data("clique.data.slideshow")){a.slideshow(b,a.utils.options(b.attr("data-slideshow")))}})})},init:function(){var b,d,e=this;this.container=this.element.hasClass("slideshow")?this.element:a.$(this.find(".slideshow")),this.slides=this.container.children(),this.slidesCount=this.slides.length,this.current=this.options.start,this.animating=!1,this.triggers=this.find("[data-slideshow-item]"),this.fixFullscreen=navigator.userAgent.match(/(iPad|iPhone|iPod)/g)&&this.container.hasClass("slideshow-fullscreen"),this.options.kenburns&&(d=this.options.kenburns===!0?"15s":this.options.kenburns,String(d).match(/(ms|s)$/)||(d+="ms")),this.slides.each(function(f){var g=a.$(this),h=g.children("img,video,iframe").eq(0);if(g.data("media",h),g.data("sizer",h),h.length){var i;switch(h[0].nodeName){case"IMG":var j=a.$('<div class="cover-background position-cover"></div>').css({"background-image":"url("+h.attr("src")+")"});h.css({width:"100%",height:"auto"}),g.prepend(j).data("cover",j);break;case"IFRAME":var k=h[0].src,l="sw-"+ ++c;h.attr("src","").on("load",function(){if((f!==e.current||f==e.current&&!e.options.videoautoplay)&&e.pausemedia(h),e.options.videomute){e.mutemedia(h);var a=setInterval(function(b){return function(){e.mutemedia(h),++b>=4&&clearInterval(a)}}(0),250)}}).data("slideshow",e).attr("data-player-id",l).attr("src",[k,k.indexOf("?")>-1?"&":"?","enablejsapi=1&api=1&player_id="+l].join("")).addClass("position-absolute"),a.support.touch||h.css("pointer-events","none"),i=!0,a.cover&&(a.cover(h),h.attr("data-cover","{}"));break;case"VIDEO":h.addClass("cover-object position-absolute"),i=!0,e.options.videomute&&e.mutemedia(h)}if(i){b=a.$("<canvas></canvas>").attr({width:h[0].width,height:h[0].height});var m=a.$('<img style="width:100%;height:auto;">').attr("src",b[0].toDataURL());g.prepend(m),g.data("sizer",m)}}else g.data("sizer",g);e.hasKenBurns(g)&&g.data("cover").css({"-webkit-animation-duration":d,"animation-duration":d})}),this.on("click.clique.slideshow","[data-slideshow-item]",function(b){b.preventDefault();var c=a.$(this).attr("data-slideshow-item");if(e.current!=c){switch(c){case"next":case"previous":e["next"==c?"next":"previous"]();break;default:e.show(parseInt(c,10))}e.stop()}}),this.slides.attr("aria-hidden","true").eq(this.current).addClass("active").attr("aria-hidden","false"),this.triggers.filter('[data-slideshow-item="'+this.current+'"]').addClass("active"),a.$win.on("resize load",a.utils.debounce(function(){e.resize(),e.fixFullscreen&&(e.container.css("height",window.innerHeight),e.slides.css("height",window.innerHeight))},100)),setTimeout(function(){e.resize()},80),this.options.autoplay&&this.start(),this.options.videoautoplay&&this.slides.eq(this.current).data("media")&&this.playmedia(this.slides.eq(this.current).data("media")),this.options.kenburns&&this.applyKenBurns(this.slides.eq(this.current)),this.container.on({mouseenter:function(){e.options.pauseOnHover&&(e.hovering=!0)},mouseleave:function(){e.hovering=!1}}),this.on("swipeRight swipeLeft",function(a){e["swipeLeft"==a.type?"next":"previous"]()}),this.on("display.uk.check",function(){e.element.is(":visible")&&(e.resize(),e.fixFullscreen&&(e.container.css("height",window.innerHeight),e.slides.css("height",window.innerHeight)))})},resize:function(){if(!this.container.hasClass("slideshow-fullscreen")){var b=this.options.height;"auto"===this.options.height&&(b=0,this.slides.css("height","").each(function(){b=Math.max(b,a.$(this).height())})),this.container.css("height",b),this.slides.css("height",b)}},show:function(c,d){if(!this.animating&&this.current!=c){this.animating=!0;var e=this,f=this.slides.eq(this.current),g=this.slides.eq(c),h=d?d:this.current<c?-1:1,i=f.data("media"),j=b[this.options.animation]?this.options.animation:"fade",k=g.data("media"),l=function(){e.animating&&(i&&i.is("video,iframe")&&e.pausemedia(i),k&&k.is("video,iframe")&&e.playmedia(k),g.addClass("active").attr("aria-hidden","false"),f.removeClass("active").attr("aria-hidden","true"),e.animating=!1,e.current=c,a.utils.checkDisplay(g,'[class*="animation-"]:not(.cover-background.position-cover)'),e.trigger("show.uk.slideshow",[g]))};e.applyKenBurns(g),a.support.animation||(j="none"),f=a.$(f),g=a.$(g),b[j].apply(this,[f,g,h]).then(l),e.triggers.removeClass("active"),e.triggers.filter('[data-slideshow-item="'+c+'"]').addClass("active")}},applyKenBurns:function(a){if(this.hasKenBurns(a)){var b=["animation-middle-left","animation-top-right","animation-bottom-left","animation-top-center","","animation-bottom-right"],c=this.kbindex||0;a.data("cover").attr("class","cover-background position-cover").width(),a.data("cover").addClass(["animation-scale","animation-reverse",b[c]].join(" ")),this.kbindex=b[c+1]?c+1:0}},hasKenBurns:function(a){return this.options.kenburns&&a.data("cover")},next:function(){this.show(this.slides[this.current+1]?this.current+1:0)},previous:function(){this.show(this.slides[this.current-1]?this.current-1:this.slides.length-1)},start:function(){this.stop();var a=this;this.interval=setInterval(function(){a.hovering||a.next()},this.options.autoplayInterval)},stop:function(){this.interval&&clearInterval(this.interval)},playmedia:function(a){if(a&&a[0])switch(a[0].nodeName){case"VIDEO":this.options.videomute||(a[0].muted=!1),a[0].play();break;case"IFRAME":this.options.videomute||a[0].contentWindow.postMessage('{ "event": "command", "func": "unmute", "method":"setVolume", "value":1}',"*"),a[0].contentWindow.postMessage('{ "event": "command", "func": "playVideo", "method":"play"}',"*")}},pausemedia:function(a){switch(a[0].nodeName){case"VIDEO":a[0].pause();break;case"IFRAME":a[0].contentWindow.postMessage('{ "event": "command", "func": "pauseVideo", "method":"pause"}',"*")}},mutemedia:function(a){switch(a[0].nodeName){case"VIDEO":a[0].muted=!0;break;case"IFRAME":a[0].contentWindow.postMessage('{ "event": "command", "func": "mute", "method":"setVolume", "value":0}',"*")}}}),b={none:function(){var b=a.$.Deferred();return b.resolve(),b.promise()},scroll:function(b,c,d){var e=a.$.Deferred();return b.css("animation-duration",this.options.duration+"ms"),c.css("animation-duration",this.options.duration+"ms"),c.css("opacity",1).one(a.support.animation.end,function(){b.removeClass(1===d?"slideshow-scroll-backward-out":"slideshow-scroll-forward-out"),c.css("opacity","").removeClass(1===d?"slideshow-scroll-backward-in":"slideshow-scroll-forward-in"),e.resolve()}.bind(this)),b.addClass(1==d?"slideshow-scroll-backward-out":"slideshow-scroll-forward-out"),c.addClass(1==d?"slideshow-scroll-backward-in":"slideshow-scroll-forward-in"),c.width(),e.promise()},swipe:function(b,c,d){var e=a.$.Deferred();return b.css("animation-duration",this.options.duration+"ms"),c.css("animation-duration",this.options.duration+"ms"),c.css("opacity",1).one(a.support.animation.end,function(){b.removeClass(1===d?"slideshow-swipe-backward-out":"slideshow-swipe-forward-out"),c.css("opacity","").removeClass(1===d?"slideshow-swipe-backward-in":"slideshow-swipe-forward-in"),e.resolve()}.bind(this)),b.addClass(1==d?"slideshow-swipe-backward-out":"slideshow-swipe-forward-out"),c.addClass(1==d?"slideshow-swipe-backward-in":"slideshow-swipe-forward-in"),c.width(),e.promise()},scale:function(b,c,d){var e=a.$.Deferred();return b.css("animation-duration",this.options.duration+"ms"),c.css("animation-duration",this.options.duration+"ms"),c.css("opacity",1),b.one(a.support.animation.end,function(){b.removeClass("slideshow-scale-out"),c.css("opacity",""),e.resolve()}.bind(this)),b.addClass("slideshow-scale-out"),b.width(),e.promise()},fade:function(b,c,d){var e=a.$.Deferred();return b.css("animation-duration",this.options.duration+"ms"),c.css("animation-duration",this.options.duration+"ms"),c.css("opacity",1),b.one(a.support.animation.end,function(){b.removeClass("slideshow-fade-out"),c.css("opacity",""),e.resolve()}.bind(this)),b.addClass("slideshow-fade-out"),b.width(),e.promise()}},a.slideshow.animations=b,window.addEventListener("message",function(b){var c,d=b.data;if("string"==typeof d)try{d=JSON.parse(d)}catch(e){d={}}b.origin&&b.origin.indexOf("vimeo")>-1&&"ready"==d.event&&d.player_id&&(c=a.$('[data-player-id="'+d.player_id+'"]'),c.length&&c.data("slideshow").mutemedia(c))},!1)});