/*!
 *  CliqueUI - v1.0.4 - 2015-10-14
 *  http://ui.cliquestudios.com
 *  Copyright (c) 2015 Clique Studios;
 */

!function(a){if("function"==typeof define&&define.amd&&define("clique-scrollspy",["clique"],function(){return a(Clique)}),!window.Clique)throw new Error("Clique.scrollspy requires Clique.core");window.Clique&&a(Clique)}(function(a){var b,c,d,e,f,g,h;return b=a.$,d=a.$win,c=a.$doc,g=[],e=function(){var b,c;for(b=0,c=[];b<g.length;)a.support.requestAnimationFrame.apply(window,[g[b].check]),c.push(b++);return c},a.component("scrollspy",{defaults:{target:!1,"class":"scrollspy-inview",initcls:"scrollspy-init-inview",topoffset:0,leftoffset:0,repeat:!1,delay:0},boot:function(){return c.on("scrolling.clique.dom",a.utils.debounce(e,150)),d.on("load resize orientationchange",a.utils.debounce(e,150)),a.ready(function(c){return b("[data-scrollspy]",c).each(function(){var c,d;c=b(this),c.data("clique.data.scrollspy")||(d=a.scrollspy(c,a.utils.options(c.attr("data-scrollspy"))))})})},init:function(){var c,d,e;return c=this,e=this.options["class"].split(/,/),d=function(){var d,f,g;return f=c.options.target?c.element.find(c.options.target):c.element,d=1===f.length?1:0,g=0,f.each(function(f){var h,i,j,k,l;h=b(this),k=h.data("inviewstate"),j=a.utils.isInView(h,c.options),l=h.data("cliqueScrollspyCls")||e[g].trim(),!j||k||h.data("scrollspy-idle")||(i||(h.addClass(c.options.initcls),c.offset=h.offset(),i=!0,h.trigger("init.clique.scrollspy")),h.data("scrollspy-idle",setTimeout(function(){return h.addClass("scrollspy-inview").toggleClass(l).width(),h.trigger("inview.clique.scrollspy"),h.data("scrollspy-idle",!1),h.data("inviewstate",!0)},c.options.delay*d)),d++),!j&&k&&c.options.repeat&&(h.data("scrollspy-idle")&&clearTimeout(h.data("scrollspy-idle")),h.removeClass("scrollspy-inview").toggleClass(l),h.data("inviewstate",!1),h.trigger("outview.clique.scrollspy")),g=e[g+1]?g+1:0})},d(),this.check=d,g.push(this)}}),h=[],f=function(){var b,c;for(b=0,c=[];b<h.length;)a.support.requestAnimationFrame.apply(window,[h[b].check]),c.push(b++);return c},a.component("scrollspynav",{defaults:{"class":"active",closest:!1,topoffset:0,leftoffset:0,smoothscroll:!1},boot:function(){return c.on("scrolling.clique.dom",f),d.on("resize orientationchange",a.utils.debounce(f,50)),a.ready(function(c){return b("[data-scrollspy-nav]",c).each(function(){var c,d;c=b(this),c.data("scrollspynav")||(d=a.scrollspynav(c,a.utils.options(c.attr("data-scrollspy-nav"))))})})},init:function(){var c,e,f,g,i,j,k;return i=[],j=this.find("a[href^='#']").each(function(){return i.push(b(this).attr("href"))}),k=b(i.join(",")),e=this.options["class"],f=this.options.closest||this.options.closest,c=this,g=function(){var b,g,h,i,l;for(g=[],b=0;b<k.length;)a.utils.isInView(k.eq(b),c.options)&&g.push(k.eq(b)),b++;if(g.length){if(i=d.scrollTop(),l=function(){for(b=0;b<g.length;){if(g[b].offset().top>=i)return g[b];b++}}(),!l)return;return c.options.closest?(j.closest(f).removeClass(e),h=j.filter("a[href='#"+l.attr("id")+"']").closest(f).addClass(e)):h=j.removeClass(e).filter("a[href='#"+l.attr("id")+"']").addClass(e),c.element.trigger("inview.clique.scrollspynav",[l,h])}},this.options.smoothscroll&&a.smoothScroll&&j.each(function(){return a.smoothScroll(this,c.options.smoothscroll)}),g(),this.element.data("scrollspynav",this),this.check=g,h.push(this)}})});